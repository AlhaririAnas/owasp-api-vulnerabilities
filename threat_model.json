{
    "summary": {
      "title": "Flask API Threat Model",
      "owner": "Anas Alhariri",
      "description": "A threat model for a Flask API with vulnerabilities such as SSRF, resource consumption, and insecure configuration.",
      "id": 1
    },
    "detail": {
      "contributors": [
        {
          "name": "Anas Alhariri"
        }
      ],
      "diagrams": [
        {
          "title": "API Threat Flow",
          "id": 1,
          "diagramJson": {
            "cells": [
              {
                "type": "tm.Actor",
                "size": {
                  "width": 160,
                  "height": 80
                },
                "position": {
                  "x": 50,
                  "y": 50
                },
                "angle": 0,
                "id": "user-actor",
                "z": 1,
                "attrs": {
                  "text": {
                    "text": "User (Browser/App)"
                  }
                },
                "threats": [
                  {
                    "status": "Open",
                    "severity": "Medium",
                    "title": "Input Validation",
                    "type": "Tampering",
                    "description": "The user can send unvalidated data to the API, potentially leading to injection attacks.",
                    "mitigation": "Ensure all user inputs are sanitized and validated."
                  }
                ]
              },
              {
                "type": "tm.Process",
                "size": {
                  "width": 160,
                  "height": 80
                },
                "position": {
                  "x": 300,
                  "y": 50
                },
                "angle": 0,
                "id": "flask-api",
                "z": 2,
                "attrs": {
                  "text": {
                    "text": "Flask API Server"
                  }
                },
                "threats": [
                  {
                    "status": "Open",
                    "severity": "High",
                    "title": "SSRF Vulnerability",
                    "type": "Information disclosure",
                    "description": "The API's /proxy endpoint allows unvalidated URLs, enabling Server Side Request Forgery.",
                    "mitigation": "Restrict allowed URLs using an allowlist and validate all input."
                  },
                  {
                    "status": "Open",
                    "severity": "Medium",
                    "title": "Denial of Service",
                    "type": "Availability",
                    "description": "The /heavy endpoint can exhaust server resources, causing a Denial of Service.",
                    "mitigation": "Implement rate-limiting and resource thresholds."
                  }
                ]
              },
              {
                "type": "tm.Store",
                "size": {
                  "width": 160,
                  "height": 80
                },
                "position": {
                  "x": 600,
                  "y": 50
                },
                "angle": 0,
                "id": "external-server",
                "z": 3,
                "attrs": {
                  "text": {
                    "text": "External Server (SSRF)"
                  }
                },
                "threats": [
                  {
                    "status": "Open",
                    "severity": "High",
                    "title": "SSRF Exploitation",
                    "type": "Information disclosure",
                    "description": "An attacker can send malicious requests to access internal servers or expose data.",
                    "mitigation": "Use network-level controls to block unauthorized requests."
                  }
                ]
              },
              {
                "type": "tm.Store",
                "size": {
                  "width": 160,
                  "height": 80
                },
                "position": {
                  "x": 300,
                  "y": 200
                },
                "angle": 0,
                "id": "database-store",
                "z": 4,
                "attrs": {
                  "text": {
                    "text": "Database (Credentials)"
                  }
                },
                "threats": [
                  {
                    "status": "Open",
                    "severity": "High",
                    "title": "Insecure Credentials",
                    "type": "Elevation of Privilege",
                    "description": "The API exposes default credentials through the /admin endpoint.",
                    "mitigation": "Secure default credentials and enforce strong authentication."
                  }
                ]
              },
              {
                "type": "tm.Boundary",
                "smooth": true,
                "source": {
                  "x": 250,
                  "y": 20
                },
                "target": {
                  "x": 400,
                  "y": 250
                },
                "vertices": [
                  {
                    "x": 320,
                    "y": 135
                  }
                ],
                "id": "trust-boundary",
                "z": 5,
                "attrs": {
                  "text": {
                    "text": "Trust Boundary"
                  }
                }
              }
            ]
          }
        }
      ],
      "reviewer": "Anas Alhariri"
    }
  }
  